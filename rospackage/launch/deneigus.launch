<launch>
  <arg name="has_web" default="0"/>
  <arg name="has_joy" default="1"/>
  
  <arg name="ard_port" default="/dev/ttyUSB0" />
  <arg name="ard_baud" default="57600" />
  <arg name="joy_port" default="/dev/input/js2" />
  
  <arg name="map_file" default="$(find deneigus)/map/rectangle.yaml"/>
  <arg name="rviz_file" default="-d $(find deneigus)/rviz/map_test.rviz"/>

  <!-- rosbridge server -->
  <group if="$(arg has_web)">
    <include file="$(find rosbridge_server)/launch/rosbridge_websocket.launch" > 
      <arg name="port" value="9090"/>
      <arg name="output" value="log"/>
    </include>
  </group>

 <!-- python executif Node -->
  <node pkg="deneigus" type="executif.py" name="executif" output="screen"/>
 <!-- python pb2ros Node -->
  <node pkg="deneigus" type="pb2ros.py" name="pb2ros" output="screen"/>

 <!-- python astar node -->
  <node pkg="deneigus" type="astar.py" name="astar" output="screen"/>

<!-- python tf_listener node -->
  <node pkg="deneigus" type="tf_listener.py" name="tf_listner" output="screen"/>

<!-- Run the map server -->
  <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_file)" />

<!-- arduino serial Node 
  <node pkg="rosserial_python" type="serial_node.py" name="serial_node">
    <param name="port" value="$(arg ard_port)"/>
    <param name="baud" value="$(arg ard_baud)"/>
  </node>
-->

<!-- joy node -->
  <group if="$(arg has_joy)">
    <node respawn="true" pkg="joy" type="joy_node" name="raw_joy">
      <param name="dev" type="string" value="$(arg joy_port)" />
      <param name="deadzone" value="0.12" />
    </node>
  </group>

<!-- RVIZ -->
  <node type="rviz" name="rviz" pkg="rviz" args="$(arg rviz_file)"/>


<!-- TFs -->
  <node pkg="tf2_ros" type="static_transform_publisher" name="sf1_broadcaster" args="0.1 -0.05 1 0 0 0 robot sonar_f_0" />
  <node pkg="tf2_ros" type="static_transform_publisher" name="sf2_broadcaster" args="0.1 0.05 1 0.34 0 0 robot sonar_f_1" />
</launch>
